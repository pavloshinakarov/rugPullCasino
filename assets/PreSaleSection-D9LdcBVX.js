import{c as u,e as f,f as P,g as T,r as b,h as v,j as e,i as j}from"./index-Bwr-Jxy8.js";import{b as A}from"./buy-token-COKkF4j7.js";/* empty css              */class E{constructor(t,r){this.address=t,this.init=r}async sendBuyJettons(t,r,l,c,n){await t.internal(r,{sendMode:u.SendMode.PAY_GAS_SEPARATELY,body:u.beginCell().storeUint(1,32).storeUint(0,64).storeAddress(l).storeAddress(c).endCell(),value:n})}async getDataWallet(t,r){const c={type:"slice",cell:u.beginCell().storeAddress(r).endCell()},{stack:n}=await t.get("get_data_wallet",[c]),m=n.readNumber(),x=n.readBigNumber(),y=n.readNumber();let p="",g="";const i=n.readCell().beginParse();try{p=i.loadAddress().toString(),g=i.loadCoins().toString()}catch{console.log("buyer not found")}const h=n.readBigNumber();return{preSale:m.toString(),balance:x.toString(),referredPercentage:y.toString(),cellBuyer:i.toString(),buyerAddress:p,buyerRpc:g,buyersCount:h.toString()}}}function I(o){const t=f(),{sender:r}=P();let l=T();const[c,n]=b.useState(null),m="EQCjsm1Y7sOyH3Dx55LvjKvKC9GJzDUOEbpykR_qsW1-7YBZ",x=d=>new Promise(s=>setTimeout(s,d)),[y,p]=b.useState(""),[g,i]=b.useState(""),h=document.getElementById("ton"),a=v(async()=>{if(!t)return;const d=new E(u.Address.parse(m));return t.open(d)},[t]);return b.useEffect(()=>{async function d(){if(!a||!l)return;let s=await a.getDataWallet(u.Address.parse(l));p(s.balance),i(s.buyerRpc.toString()),await x(3e4),d()}d()},[a]),{value:{balance:y,buyerRpc:g},address:a==null?void 0:a.address.toString(),sendBuyJettons:()=>{if(l){if(o||(o=l),Number(h.value)<1){n("The minimum purchase is 1 TON");return}return a==null?void 0:a.sendBuyJettons(r,u.Address.parse(l),u.Address.parse(o),u.toNano(Number(h.value)))}},modalMessage:c,closeModal:()=>n(null)}}const M=({message:o,onClose:t})=>e.jsxs("div",{className:"modal-overlay",children:[e.jsx("button",{className:"modal-close",onClick:t,children:"Ã—"}),e.jsx("div",{className:"modal-content modal-referral",children:e.jsxs("div",{className:"modal-info",children:[e.jsx("div",{className:"header-modal",children:e.jsx("img",{src:j,className:"title-modal-presale"})}),e.jsx("hr",{className:"hr-modal"}),o]})})]}),O=()=>{function o(s){return localStorage.getItem(s)}const t=o("referrerWallet"),{value:r,sendBuyJettons:l,modalMessage:c,closeModal:n}=I(t),[m,x]=b.useState(0),[y,p]=b.useState(""),[g,i]=b.useState("");function h(){const N=Math.floor(Date.now()/1e3)-1728169508,C=Math.floor(N/(7*86400)),S=1e3+2*(N%(7*86400)/86400);return 1e4*((1<<C)*(S/1e3))/1e9}const a=()=>{let s=parseFloat(g)*parseFloat(m);p(s.toFixed(10))},d=()=>{let s=parseFloat(y)*parseFloat(m);i(s.toFixed(10))};return setInterval(()=>{let s=h();x(s)},300),e.jsxs("div",{className:"pre-sale",children:[e.jsx("img",{src:j,className:"sub-title"}),e.jsxs("div",{className:"container-info-presale",children:[e.jsxs("p",{children:["Current RPC token price: $",m.toFixed(10)," TON"]}),e.jsxs("p",{children:["Total RPC tokens selled: $",r.balance," RPC"]}),e.jsxs("p",{children:["Your RPC tokens: $ ",r.buyerRpc," RPC"]}),e.jsx("p",{children:"Buy RPC tokens with TON"})]}),e.jsxs("div",{className:"container-input-nano",children:[e.jsxs("label",{children:["$ ",e.jsx("input",{id:"rpc",type:"number",className:"input-nano",value:g,onChange:s=>i(s.target.value),onKeyUp:a})," RPC"]}),e.jsxs("label",{children:["$ ",e.jsx("input",{id:"ton",type:"number",className:"input-nano",value:y,onChange:s=>p(s.target.value),onKeyUp:d})," TON"]})]}),e.jsx("button",{className:"button-buy",onClick:()=>{l()},children:e.jsx("img",{src:A,className:""})}),e.jsx("button",{className:"button-claim",disabled:!0,children:"CLAIM"}),c?e.jsx(M,{message:c,onClose:n}):""]})};export{O as default};
